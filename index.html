<!DOCTYPE html>
<html>
  <head>
    <title>Remark</title>
    <script src="javascripts/remark-latest.min.js" type="text/javascript"></script>
    <script src="javascripts/d3.v4.js" type="text/javascript"></script>
    <link href="stylesheets/default.css" rel="stylesheet" type="text/css">
    <meta content='initial-scale=0.5' name='viewport'>
  </head>
  <body>
    <textarea id='source'>class: center, middle, inverse&#x000A;&#x000A;# D3 V4 - What's new?&#x000A;&#x000A;Play along:&#x000A;&#x000A;[D3 v3 playground](http://jsbin.com/degoxo/1/edit?html,js,console,output) |&#x000A;[D3 v4 playground](http://jsbin.com/yoruka/1/edit?html,js,console,output) &#x000A;&#x000A;Slides: [iros.github.io/d3-v4-whats-new/](http://iros.github.io/d3-v4-whats-new/#1)&#x000A;&#x000A;&#x000A;[![bocoup](stylesheets/images/bocoup.png)](http://bocoup.com/datavis)&#x000A;<div class="bottom-left">&#x000A;<a href="http://ireneros.com">Irene Ros</a><br/>&#x000A;<a href="http://twitter.com/ireneros">@ireneros</a><br/>&#x000A;irene@bocoup.com <br/>&#x000A;</div>&#x000A;&#x000A;&#x000A;---&#x000A;&#x000A;# Modularity&#x000A;&#x000A;#### D3 v3 was one large library. You had to include all of it, even if you didn't need all of it.&#x000A;&#x000A;--&#x000A;&#x000A;#### D3 v4 is actually a set of small modules. You can choose to use one or more as you need them.&#x000A;&#x000A;https://github.com/d3/&#x000A;&#x000A;![modules](https://i.gyazo.com/d4661085579da7bbbf82e47ca62022db.png)&#x000A;&#x000A;---&#x000A;&#x000A;# Modularity&#x000A;&#x000A;For example: `https://github.com/d3/d3-scale`&#x000A;Can be installed via npm:&#x000A;&#x000A;`npm install d3-scale`&#x000A;&#x000A;--&#x000A;&#x000A;Note that each module has it's own dependencies. When installing them via npm, they&#x000A;will be pulled down for you, but if you were to include them manually, you need to &#x000A;make sure those are included as well. For example:&#x000A;&#x000A;```html&#x000A;<script src="https://d3js.org/d3-array.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-collection.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-color.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-format.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-interpolate.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-time.v1.min.js"></script>&#x000A;<script src="https://d3js.org/d3-time-format.v2.min.js"></script>&#x000A;<script src="https://d3js.org/d3-scale.v1.min.js"></script>&#x000A;```&#x000A;&#x000A;Most likely you will use some sort of build system to package your JS. Mike Bostock&#x000A;has suggested using [Rollup](http://rollupjs.org/) an example of which you can &#x000A;find [here](http://bl.ocks.org/mbostock/bb09af4c39c79cffcde4). &#x000A;&#x000A;---&#x000A;&#x000A;# Modularity&#x000A;&#x000A;You can still use the entire v4 build by including it using your favorite method:&#x000A;&#x000A;```html&#x000A;<script src="https://d3js.org/d3.v4.js"></script>&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Namespacing&#x000A;&#x000A;D3 v3's API was logically namespaced. For example:&#x000A;&#x000A;* `d3.scale.linear`&#x000A;* `d3.scale.ordinal`&#x000A;* `d3.time.format`&#x000A;* `d3.svg.axis`&#x000A;&#x000A;--&#x000A;&#x000A;In D3 v4, all modules share a flat namespace `d3.*` as a result of adopting ES6 modules.&#x000A;&#x000A;* `d3.scale.linear` is now `d3.scaleLinear`&#x000A;* `d3.layout.treemap` is now `d3.treemap`&#x000A;&#x000A;--&#x000A;&#x000A;This does mean you can't just swap in D3 v4 and expect it to work.&#x000A;&#x000A;---&#x000A;&#x000A;# Method accessors&#x000A;&#x000A;Many utility methods now take an accessor method that has a consistent signature:&#x000A;&#x000A;`function(d, i, data) {...}`&#x000A;&#x000A;For example:&#x000A;&#x000A;```javascript&#x000A;var settlersData = [&#x000A;  {name: "Wood", count: 2},&#x000A;  {name: "Ore", count: 3},&#x000A;  {name: "Sheep", count: 4},&#x000A;  {name: "Wheat", count: 1}&#x000A;];&#x000A;&#x000A;d3.min(settlersData, function(d, i, data) {&#x000A;  return d.count;&#x000A;});&#x000A;```&#x000A;&#x000A;Previously some methods were not consistent about this (for example, `d3.quantile`).&#x000A;&#x000A;---&#x000A;&#x000A;# Canvas Rendering&#x000A;&#x000A;In v3, d3's few actual rendering methods only rendered to SVG. Starting v4, many &#x000A;of the rendering helpers now have a new `context` method that lets you pass in&#x000A;a Canvas context to render to.&#x000A;&#x000A;For example:&#x000A;&#x000A;```javascript&#x000A;var line = d3.line()&#x000A;    .x(function(d) { return x(d.date); })&#x000A;    .y(function(d) { return y(d.value); });&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;To render SVG:&#x000A;```javascript&#x000A;path.datum(data).attr("d", line);&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;To render to Canvas:&#x000A;```javascript&#x000A;line.context(context)(data);&#x000A;```&#x000A;&#x000A;You can see more examples in the shapes module: [d3-shape](https://github.com/d3/d3-shape/blob/master/README.md).&#x000A;&#x000A;---&#x000A;&#x000A;# Selections&#x000A;&#x000A;* Selections no longer subclass Array by extending its prototype. They are now plain objects.&#x000A;&#x000A;--&#x000A;&#x000A;* There is a new method called `.nodes` to retrieve all nodes within a selection as an array.&#x000A;&#x000A;--&#x000A;&#x000A;* Selections are immutable (parents and elemnts never change, though their attributes do.) For example.&#x000A;`selection.sort` will return a new selection.&#x000A;&#x000A;---&#x000A;&#x000A;# Selections&#x000A;&#x000A;* `selection.append` now inserts elements in the order of the data bound, instead of&#x000A;at the end:&#x000A;&#x000A;For example, in v3:&#x000A;``` javascript&#x000A;d3.select("body").selectAll("span").data([1, 3, 5], String).enter().append("span").text(String);&#x000A;d3.select("body").selectAll("span").data([1, 2, 3, 4, 5], String).enter().append("span").text(String);&#x000A;// 13524&#x000A;```&#x000A;&#x000A;In v4:&#x000A;``` javascript&#x000A;d3.select("body").selectAll("span").data([1, 3, 5], String).enter().append("span").text(String);&#x000A;d3.select("body").selectAll("span").data([1, 2, 3, 4, 5], String).enter().append("span").text(String);&#x000A;// 12345&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* New lifecycle event (ish)! `merge`.&#x000A;&#x000A;---&#x000A;&#x000A;[example](http://jsbin.com/cipebe/4/edit?html,js,console,output)&#x000A;&#x000A;In v3:&#x000A;```javascript&#x000A;var circleBinding = svg.selectAll("circle").data(data);&#x000A; &#x000A;circleBinding.style("fill", "blue"); // UPDATE&#x000A;&#x000A;circleBinding.exit().remove(); // EXIT&#x000A;&#x000A;circleBinding.enter().append("circle") // ENTER; modifies UPDATE!&#x000A;    .style("fill", "green");&#x000A;&#x000A;circleBinding // ENTER + UPDATE&#x000A;    .style("stroke", "black");&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;In v4:&#x000A;```javascript&#x000A;var circleBinding = svg.selectAll("circle").data(data); &#x000A;&#x000A;circleBinding.style("fill", "blue"); // UPDATE&#x000A;&#x000A;circleBinding.exit().remove(); // EXIT&#x000A;&#x000A;circleBinding.enter().append("circle") // ENTER&#x000A;    .style("fill", "green")&#x000A;&#x000A;  .merge(circleBinding) // ENTER + UPDATE&#x000A;    .style("stroke", "black");&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Selections ([d3-selection](https://github.com/d3/d3-selection/blob/master/README.md))&#x000A;&#x000A;* To move a selection to the front of its siblings call `selection.raise`. To move it backwards, call `selection.lower`&#x000A;&#x000A;--&#x000A;&#x000A;* You can dispatch events on selections using `selection.dispatch`&#x000A;&#x000A;--&#x000A;&#x000A;* The `selection.call` method no longer sets `this` to be the selection. It is now passed as the first&#x000A;argument to the callback.&#x000A;&#x000A;In v3:&#x000A;&#x000A;&#x000A;```javascript&#x000A;d3.selectAll("div.states")&#x000A;  .call(function() {&#x000A;    this.style('color', 'red');&#x000A;  })&#x000A;```&#x000A;&#x000A;In V4:&#x000A;&#x000A;```javascript&#x000A;d3.selectAll("div.states")&#x000A;  .call(function(statesSelection) {&#x000A;    statesSelection.style('color', 'red');&#x000A;  })&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Multi-Selections ([d3-selection-multi](https://github.com/d3/d3-selection-multi))&#x000A;&#x000A;In d3 v3, you could easily set multiple style or attribute properties like this:&#x000A;&#x000A;```javascript&#x000A;d3.select("h4").style({&#x000A;  color: "red", background: "yellow"&#x000A;});&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;In v4, you can no longer do that. Even this does not work:&#x000A;&#x000A;```javascript&#x000A;d3.select("h4").style({ color: "red" }); &#x000A;```&#x000A;&#x000A;Instead, you have to set the key and value explicitly:&#x000A;&#x000A;```javascript&#x000A;d3.select("h4").style("color", "red"); &#x000A;```&#x000A;---&#x000A;&#x000A;# Multi-Selections ([d3-selection-multi](https://github.com/d3/d3-selection-multi))&#x000A;&#x000A;Multi-selections allows you to set multiple properties with one call, but it is&#x000A;*not included by default* with the standard build. You have to include it yourself:&#x000A;&#x000A;```html&#x000A;<script src="https://d3js.org/d3.v4.min.js"></script>&#x000A;<script src="https://d3js.org/d3-selection-multi.v0.4.min.js"></script>&#x000A;```&#x000A;&#x000A;This will let you:&#x000A;&#x000A;```javascript&#x000A;var div = d3.selectAll("div")&#x000A;    .attrs({ "title": "Hello, world!", "name" : "greeter" })&#x000A;    .styles({ "color": "red", "background" : "green" });&#x000A;```&#x000A;&#x000A;Note that it's `styles` and `attrs`, not `style` and `attr` as before.&#x000A;&#x000A;---&#x000A;&#x000A;# Transitions ([d3-transition](https://github.com/d3/d3-transition/blob/master/README.md))&#x000A;&#x000A;You can create transitions and then share them across selections&#x000A;&#x000A;```javascript&#x000A;var t = d3.transition()&#x000A;    .duration(750)&#x000A;    .ease(d3.easeLinear);&#x000A;&#x000A;d3.selectAll(".apple").transition(t)&#x000A;    .style("fill", "red");&#x000A;&#x000A;d3.selectAll(".orange").transition(t)&#x000A;    .style("fill", "orange");&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Transitions ([d3-transition](https://github.com/d3/d3-transition/blob/master/README.md))&#x000A;&#x000A;Delays are now relative to previous transition, not the first transition&#x000A;&#x000A;```javascrit&#x000A;d3.selectAll(".apple")&#x000A;  .transition() // First fade to green.&#x000A;    .style("fill", "green")&#x000A;  .transition() // Then red.&#x000A;    .style("fill", "red")&#x000A;  .transition() // Wait one second. Then brown, and remove.&#x000A;    .delay(1000)&#x000A;    .style("fill", "brown")&#x000A;    .remove();&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* `selection.interrupt` stops active transitions and cancels all scheduled transitions on the selection.&#x000A;&#x000A;--&#x000A;&#x000A;* All transition callbacks recieve the standard arguments `(d, i, nodes)` - which impacts in particular the `attrTween` and `styleTween` functions which took a tween function or style value as the third argument.&#x000A;&#x000A;---&#x000A;&#x000A;* `d3.active` lets you select a transition that is currently active on a given node. &#x000A;&#x000A;[Example](http://bl.ocks.org/mbostock/70d5541b547cc222aa02)&#x000A;&#x000A;```javascript&#x000A;&#x000A;var whiteblue = d3.interpolateRgb("#eee", "steelblue"),&#x000A;    blueorange = d3.interpolateRgb("steelblue", "orange"),&#x000A;    orangewhite = d3.interpolateRgb("orange", "#eee");&#x000A;&#x000A;d3.select("body").selectAll("div")&#x000A;    .data(d3.range(n))&#x000A;  .enter().append("div")&#x000A;  .transition()&#x000A;    .delay(function(d, i) { return i + Math.random() * n / 4; })&#x000A;    .ease(d3.easeLinear)&#x000A;    .on("start", function repeat() {&#x000A;        d3.active(this)&#x000A;            .styleTween("background-color", function() { return whiteblue; })&#x000A;          .transition()&#x000A;            .delay(1000)&#x000A;            .styleTween("background-color", function() { return blueorange; })&#x000A;          .transition()&#x000A;            .delay(1000)&#x000A;            .styleTween("background-color", function() { return orangewhite; })&#x000A;          .transition()&#x000A;            .delay(n)&#x000A;            .on("start", repeat);&#x000A;      });&#x000A;```&#x000A;&#x000A;&#x000A;&#x000A;---&#x000A;&#x000A;# Scales ([d3-scale](https://github.com/d3/d3-scale/blob/master/README.md))&#x000A;&#x000A;* Lots of renaming:&#x000A;&#x000A; * `d3.scale.linear` &#8594; `d3.scaleLinear`&#x000A; * `d3.scale.sqrt` &#8594; `d3.scaleSqrt`&#x000A; * `d3.scale.pow` &#8594; `d3.scalePow`&#x000A;&#x000A;--&#x000A;&#x000A;* Scales now generate ticks in the same order as the domain (useful if you have a descending scale)&#x000A;&#x000A;--&#x000A;&#x000A;* You can specify what to do when a scale recieves a value that is outside the domain using `.unknown`:&#x000A;&#x000A;```javascript&#x000A;var x = d3.scaleOrdinal()&#x000A;    .domain([0, 1])&#x000A;    .range(["red", "blue"])&#x000A;    .unknown(undefined);&#x000A;&#x000A;x(0) // "red"&#x000A;x(2); // undefined&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Scales ([d3-scale](https://github.com/d3/d3-scale/blob/master/README.md))&#x000A;&#x000A;* Categorical color scales have changed. They have been renamed: `d3.scale.category10` &#8594; `d3.schemeCategory10` and they are no longer actual scales but just array of numbers:&#x000A;&#x000A;In v3:&#x000A;&#x000A;```javascript&#x000A;var color = d3.scale.category10();&#x000A;```&#x000A;&#x000A;In V4:&#x000A;```javascript&#x000A;var color = d3.scaleOrdinal(d3.schemeCategory10);&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* New sequential scales - instead of outputting to a range, they use an interpolator. Most useful for sequential color schemes. Lots of new interplators inspired by matplotlib's perceptually motivated colormaps.&#x000A;&#x000A;```javascript&#x000A;z = d3.scaleSequential(d3.interpolateViridis);&#x000A;```&#x000A;&#x000A;![interpolateViridis](https://i.gyazo.com/b531e023ced883ee075df093336aae01.png)&#x000A;&#x000A;---&#x000A;&#x000A;# Histograms ([d3-array](https://github.com/d3/d3-array/blob/master/README.md))&#x000A;&#x000A;### `d3.histogram`&#x000A;&#x000A;In v4:&#x000A;```javascript&#x000A;var values = [&#x000A;  { val : 1 }, { val : 1 }, { val : 4 }, { val : 5 }, { val : 23 }, &#x000A;  { val : 1 }, { val : 4 }&#x000A;];&#x000A;var hist = d3.histogram()&#x000A;  .thresholds(3)&#x000A;  .value(function(d) { &#x000A;    return d.val; &#x000A;  }); &#x000A;```&#x000A;---&#x000A;&#x000A;# Histograms ([d3-array](https://github.com/d3/d3-array/blob/master/README.md))&#x000A;&#x000A;### `d3.histogram`&#x000A;&#x000A;* `d3.layouts.histogram` is now `d3.histogram`&#x000A;&#x000A;--&#x000A;&#x000A;* The `bins` method, was renamed to `thresholds`&#x000A;&#x000A;--&#x000A;&#x000A;* `dx` which specified the bin width is gone, there are now `x0` and `x1` which specify the start and end range&#x000A;of a bin. `x0` will equal the `x1` of the previous bin.&#x000A;&#x000A;--&#x000A;&#x000A;The binning is also now different. In v3 the values we have for `x` and `dx` are:&#x000A;&#x000A;`[1, 7.33333] [8.33333333, 7.33333], [15.666666666666666, 7.33333]`&#x000A;&#x000A;In V4 the bins are:&#x000A;&#x000A;`[1, 10] [10, 20] [20, 23]`&#x000A;&#x000A;---&#x000A;&#x000A;# Axes ([d3-axis](https://github.com/d3/d3-axis/blob/master/README.md))&#x000A;&#x000A;In v3, you had to style the axes or it would look like this:&#x000A;&#x000A;![v3 axes](https://raw.githubusercontent.com/d3/d3/master/img/axis-v3.png)&#x000A;&#x000A;```css&#x000A;.axis path,&#x000A;.axis line {&#x000A;  fill: none;&#x000A;  stroke: #000;&#x000A;  shape-rendering: crispEdges;&#x000A;}&#x000A;&#x000A;.axis text {&#x000A;  font: 10px sans-serif;&#x000A;}&#x000A;```&#x000A;&#x000A;```javascript&#x000A;d3.select(".axis")&#x000A;    .call(d3.svg.axis()&#x000A;        .scale(x)&#x000A;        .orient("bottom"));&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Axes ([d3-axis](https://github.com/d3/d3-axis/blob/master/README.md))&#x000A;&#x000A;In v4, styling is taken care of:&#x000A;&#x000A;```javascript&#x000A;var x = d3.scaleLinear()&#x000A;  .domain([1,10])&#x000A;  .range([1,300]);&#x000A;&#x000A;var axis = d3.axisTop(x);&#x000A;&#x000A;d3.select("body").append("svg")&#x000A;    .attr("class", "axis")&#x000A;    .attr("width", 310)&#x000A;    .attr("height", 30)&#x000A;  .append("g")&#x000A;    .attr("transform", "translate(0,20)")&#x000A;    .call(axis);&#x000A;```&#x000A;&#x000A;Results in:&#x000A;&#x000A;![v4 axes](https://i.gyazo.com/95a8056bc4643c05a8f4e651cab14840.png)&#x000A;&#x000A;The default styles have been changed to offset the axis by 0.5px which fixes a crisp-edges rendering issue on safari where the axis would be drawn 2px thick.&#x000A;&#x000A;---&#x000A; &#x000A;# Axes ([d3-axis](https://github.com/d3/d3-axis/blob/master/README.md))&#x000A;&#x000A;* Note that instead of setting the axis orientation we now use&#x000A; * `axisLeft`&#x000A; * `axisRight`&#x000A; * `axisTop`&#x000A; * `axisBottom`&#x000A;&#x000A;--&#x000A;&#x000A;`axis.tickArguments([20, "s"])` - shorthand for calling `axis.ticks(20)` and `axis.tickFormat(d3.format("s"))`.&#x000A;&#x000A;---&#x000A;&#x000A;# Collections ([d3-collections](https://github.com/d3/d3-collection/blob/master/README.md))&#x000A;&#x000A;Aggregates all functions having to do with data structures&#x000A;* Objects&#x000A;* Maps&#x000A;* Sets&#x000A;* Nests&#x000A;&#x000A;---&#x000A;&#x000A;# Collections ([d3-collections](https://github.com/d3/d3-collection/blob/master/README.md))&#x000A;&#x000A;### d3.set&#x000A;&#x000A;* Renamed: `set.forEach` to `set.each`&#x000A;* Now accepts an accessor function&#x000A;&#x000A;```javascript&#x000A;var values = [&#x000A;  { val : 1 },&#x000A;    { val : 1 },&#x000A;    { val : 4 },&#x000A;    { val : 5 },&#x000A;    { val : 23 },&#x000A;    { val : 1 },&#x000A;    { val : 4 }&#x000A;];&#x000A;var x  = d3.set(values, function(d) { &#x000A;  return d.val; &#x000A;}); // [1,4,5,23]&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Collections ([d3-collections](https://github.com/d3/d3-collection/blob/master/README.md))&#x000A;&#x000A;### d3.map&#x000A;&#x000A;* Renamed: `map.forEach` &#8594; `map.each`.&#x000A;* Argument order changed for each callback to `(value, key, map)`:&#x000A;&#x000A;```javascript&#x000A;var values = [&#x000A;  { val : 1, name: "One"},&#x000A;    { val : 1, name: "One" },&#x000A;    { val : 4, name: "Four" },&#x000A;    { val : 5, name: "Five" },&#x000A;    { val : 23, name: "TwentyThree" },&#x000A;    { val : 1, name: "One" }&#x000A;];&#x000A;var x  = d3.map(values, function(d) { return d.name; });&#x000A;x.each(function(val, key, map) {&#x000A;  console.log(val);&#x000A;}); // { val : 1, name: "One"},  { val : 4, name: "Four" }, { val : 5, name: "Five" },...&#x000A;```&#x000A;&#x000A;In V3, the order was `(key, value)`. So if you would get:&#x000A;`["One", "Four", "Five", "TwentyThree"]` if you forget to reverse your callback variables...&#x000A;&#x000A;---&#x000A;&#x000A;# Collections ([d3-collections](https://github.com/d3/d3-collection/blob/master/README.md))&#x000A;&#x000A;### Both d3.set and d3.map&#x000A;&#x000A;* Return the collection, when you call `.add` to add a new element, instead of the added value.&#x000A;* Have new `.clear` methods to clear the collections.&#x000A;&#x000A;---&#x000A;&#x000A;&#x000A;# Arrays ([d3-array](https://github.com/d3/d3-array/blob/master/README.md))&#x000A;&#x000A;### `d3.scan(arr, fn)`&#x000A;&#x000A;D3 v3's `d3.min` and `d3.max` would return the min or max element appropriately, but&#x000A;you couldn't easily find out the original position of that element. In v4, `d3.scan`&#x000A;does just that using a comparator function.&#x000A;&#x000A;```javascript&#x000A;var settlersData = [&#x000A;  {name: "Wood", count: 2},&#x000A;  {name: "Ore", count: 3},&#x000A;  {name: "Sheep", count: 4},&#x000A;  {name: "Wheat", count: 1}&#x000A;];&#x000A;&#x000A;var idx = d3.scan(settlersData, function(a, b) { &#x000A;  return a.count - b.count; &#x000A;}); // 3&#x000A;settlersData[idx]; // {name: "Wheat", count: 1}&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Arrays ([d3-array](https://github.com/d3/d3-array/blob/master/README.md))&#x000A;&#x000A;### `d3.ticks(start, end, count)`&#x000A;&#x000A;A new method that will generate an array of `count+1` items equally spaced between&#x000A;`start` and `end`.&#x000A;&#x000A;```javascript&#x000A;var ticks = d3.ticks(0, 10, 5); // [0, 2, 4, 6, 8, 10]&#x000A;```&#x000A;&#x000A;Note that this method has nothing to do with axes.&#x000A;&#x000A;### `d3.tickStep(start, end, count)`&#x000A;&#x000A;Will give you the space between values that you would obtain from `d3.ticks`:&#x000A;&#x000A;```javascript&#x000A;d3.tickStep(0,10,5);&#x000A;// 2&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Arrays ([d3-array](https://github.com/d3/d3-array/blob/master/README.md))&#x000A;&#x000A;###`d3.range(start, end, increment)`&#x000A;&#x000A;Floating point math is fun:&#x000A;&#x000A;`0.2 * 3 = 0.6000000000000001`&#x000A;&#x000A;In D3 v3, `d3.range` tried to handle this:&#x000A;&#x000A;```javascript&#x000A;d3.range(0, 1, 0.2) // [0, 0.2, 0.4, 0.6, 0.8]&#x000A;```&#x000A;&#x000A;D3 v4's `d3.range` no longer does that:&#x000A;&#x000A;```javascript&#x000A;d3.range(0, 1, 0.2) // [0, 0.2, 0.4, 0.6000000000000001, 0.8]&#x000A;```&#x000A;&#x000A;This only matters if you are dealing with floating point numbers and you can&#x000A;always use `d3.format` to present them more consistently.&#x000A;&#x000A;---&#x000A;&#x000A;# Colors ([d3-color](https://github.com/d3/d3-color/blob/master/README.md))&#x000A;&#x000A;* All colors now have an opacity method exposed: `.opacity` which takes a value from 0 to 1.&#x000A;&#x000A;--&#x000A;&#x000A;* You can also pass an optional opacity argument to `d3.rgb`, `d3.hsl`, `d3.lab`, `d3.hcl` or `d3.cubehelix`.&#x000A;&#x000A;--&#x000A;&#x000A;* You can now parse CSS color specifiers with `d3.color`:&#x000A;&#x000A;```javascript&#x000A;var red = d3.color("hsl(0, 80%, 50%)"); &#x000A;// {h: 0, l: 0.5, s: 0.8, opacity: 1}&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* The `toString` method will now return an `rgb` or `rgba` string in the form of `rgb(12,13,42)`.&#x000A;&#x000A;--&#x000A;&#x000A;* There is no more `.hsl` method on a color instance. To convert a color to hsl call the `d3.hsl` helper method:&#x000A;&#x000A;```javascript&#x000A;d3.hsl(red) &#x000A;// Color instance: {h: 0, s: 0.8, l: 0.5, opacity: 1}&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* New method called `color.displayable()` will return false if the color is [out of gamut](https://en.wikipedia.org/wiki/Gamut).&#x000A;&#x000A;---&#x000A;&#x000A;# Easing ([d3-ease](https://github.com/d3/d3-ease/blob/master/README.md))&#x000A;&#x000A;In v3, you used easing function string names to specify the ones you wanted like "linear" or "cubic-in-out".&#x000A;In V4, we use methods instead:&#x000A;&#x000A;Instead of:&#x000A;&#x000A;```javascript&#x000A;var e = d3.ease("elastic-out-in", 1.2);&#x000A;```&#x000A;&#x000A;Use:&#x000A;```javascript&#x000A;var e = d3.easeElastic.amplitude(1.2);&#x000A;```&#x000A;&#x000A;[Visual reference](https://github.com/d3/d3-ease/blob/master/README.md) for the functions &#x000A;&#x000A;[Animated version](http://bl.ocks.org/mbostock/248bac3b8e354a9103c4)&#x000A;&#x000A;---&#x000A;&#x000A;# Dispatching ([d3-dispatch](https://github.com/d3/d3-dispatch/blob/master/README.md))&#x000A;&#x000A;* Instead of exposing individual methods for each event type, you just use `call` to &#x000A;fire off an event (note these are different from the `selection.call`).&#x000A;&#x000A;In V3:&#x000A;&#x000A;```javascript&#x000A;dispatcher.foo.call(that, "Hello, Foo!");&#x000A;```&#x000A;&#x000A;In V4:&#x000A;```javascript&#x000A;dispatcher.call("foo", that, "Hello, Foo!");&#x000A;```&#x000A;--&#x000A;&#x000A;* The `on` method accepts multiple event names, separated by a space:&#x000A;&#x000A;```javascript&#x000A;dispatcher.on("foo bar", function(message) {&#x000A;  console.log(message);&#x000A;});&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Brushing ([d3-brush](https://github.com/d3/d3-brush/blob/master/README.md))&#x000A;&#x000A;&#x000A;* `d3.svg.brush` is now `d3.brush`&#x000A;&#x000A;--&#x000A;&#x000A;* There are now 3 classes for brushing along the x, y or both dimensions: `d3.brushX`, `d3.brushY` or `d3.brush`.&#x000A;&#x000A;--&#x000A;&#x000A;* Brush is no longer depending on scales - they define a selection in screen coordinates and you can invert it using a scale of choice.&#x000A;&#x000A;--&#x000A;&#x000A;* You can restrict a brushing area to a `brush.extent`, otherwise it defaults to the full SVG element.&#x000A;&#x000A;--&#x000A;&#x000A;* A brush doesn't store the active selection - it is now stored on the element to which the brush was applied. You can access it either via:&#x000A; * a brush event - retrieve element by calling `event.selection`.&#x000A; * Call `d3.brushSelection` on any given element.&#x000A;&#x000A;--&#x000A;&#x000A;* You can move the brush by calling `brush.move`&#x000A;&#x000A;--&#x000A;&#x000A;* There are now default styling applied, so you don't have to add them manually.&#x000A;&#x000A;---&#x000A;&#x000A;# Brushing ([d3-brush](https://github.com/d3/d3-brush/blob/master/README.md))&#x000A;&#x000A;### `d3.brush`&#x000A;&#x000A;```javascript&#x000A;var brush = d3.brush()&#x000A;    .on("start brush", brushed)&#x000A;    .on("end", brushended);&#x000A;&#x000A;function brushed() {&#x000A;  var s = d3.event.selection;&#x000A;  //...&#x000A;}&#x000A;&#x000A;function brushended() {&#x000A;  if (!d3.event.selection) {&#x000A;    //...&#x000A;  }&#x000A;}&#x000A;&#x000A;svg.append("g")&#x000A;  .attr("class", "brush")&#x000A;  .call(brush)&#x000A;  .call(brush.move, [[307, 167], [611, 539]]);&#x000A;```&#x000A;&#x000A;Example: http://bl.ocks.org/mbostock/0d20834e3d5a46138752f86b9b79727e&#x000A;&#x000A;---&#x000A;&#x000A;# Dragging ([d3-drag](https://github.com/d3/d3-drag/blob/master/README.md))&#x000A;&#x000A;* `d3.behavior.drag` &#8594; `d3.drag`&#x000A;&#x000A;* There's a new method called `subject` which lets you define an accessor to return what is being&#x000A;dragged. This is useful when using canvas, since there are no DOM nodes representing the content. The result&#x000A;of this accessor function call will be available on a drag event under d3.event.subject. Example: http://bl.ocks.org/mbostock/444757cc9f0fde320a5f469cd36860f4&#x000A;&#x000A;--&#x000A;&#x000A;* There is now an `on` method to bind to start, end and drag events:&#x000A;&#x000A;```javascript&#x000A;canvas.call(d3.drag()&#x000A;    .subject(dragsubject)&#x000A;    .on("start", dragstarted)&#x000A;    .on("drag", dragged)&#x000A;    .on("end", dragended)&#x000A;    .on("start.render drag.render end.render", render));&#x000A;&#x000A;```&#x000A;&#x000A;--&#x000A;&#x000A;* There are also `d3.dragEnable` and `d3.dragDisable` methods to control dragging support at a &#x000A;higher level.&#x000A;&#x000A;---&#x000A;&#x000A;# Force layout ([d3-force](https://github.com/d3/d3-force/blob/master/README.md))&#x000A;&#x000A;* Renamed: `d3.layout.force` &#8594; `d3.forceSimulation`.&#x000A;&#x000A;--&#x000A;&#x000A;* The force algorithm changed to track node velocity (`node.vx` and `node.vy`) and position (`node.x` and `node.y`, not just position (formally `node.px` and `node.py`).&#x000A;&#x000A;--&#x000A;&#x000A;* Initial node position is now [deterministic](https://raw.githubusercontent.com/d3/d3-force/master/img/phyllotaxis.png)&#x000A;&#x000A;--&#x000A;&#x000A;* If you need to find the closest node to a pointer, you no longer have to use a Voronoi SVG overlay, you can call `simulation.find`. &#x000A;&#x000A;--&#x000A;&#x000A;* Old v3 version of [Les Miserables](http://bl.ocks.org/timelyportfolio/5049980). In v4: [Les Miserables](https://bl.ocks.org/mbostock/4062045) with [dragging](http://bl.ocks.org/mbostock/ad70335eeef6d167bc36fd3c04378048)&#x000A;&#x000A;``` javascript&#x000A;var simulation = d3.forceSimulation()&#x000A;  .force("link", d3.forceLink().id(function(d) { return d.id; }))&#x000A;  .force("charge", d3.forceManyBody())&#x000A;  .force("center", d3.forceCenter(width / 2, height / 2));&#x000A;&#x000A;simulation&#x000A;  .nodes(graph.nodes)&#x000A;  .on("tick", ticked);&#x000A;&#x000A;simulation.force("link")&#x000A;  .links(graph.links);  &#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Hierarchies ([d3-hierarchy](https://github.com/d3/d3-hierarchy/blob/master/README.md))&#x000A;&#x000A;* Lots of renaming:&#x000A; * `d3.layout.cluster` &#8594; `d3.cluster`&#x000A; * `d3.layout.hierarchy` &#8594; `d3.hierarchy`&#x000A;&#x000A;* New useful method `d3.stratify` to convert flat arrays of objects into the hierarchical structures required by hierarchical layouts:&#x000A;&#x000A;```json&#x000A;[&#x000A;  {"name": "Eve",   "parent": ""},&#x000A;  {"name": "Cain",  "parent": "Eve"},&#x000A;  {"name": "Seth",  "parent": "Eve"},&#x000A;  {"name": "Enos",  "parent": "Seth"}&#x000A;]&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;To convert to a hierarchy:&#x000A;```javascript&#x000A;var root = d3.stratify()&#x000A;    .id(function(d) { return d.name; })&#x000A;    .parentId(function(d) { return d.parent; })&#x000A;    (table);&#x000A;```&#x000A;&#x000A;![image](https://raw.githubusercontent.com/d3/d3-hierarchy/master/img/stratify.png)&#x000A;&#x000A;---&#x000A;&#x000A;# Hierarchies ([d3-hierarchy](https://github.com/d3/d3-hierarchy/blob/master/README.md))&#x000A;&#x000A;* All heirarhical layouts now expect a hierarchy object. So if you already have json in the right form&#x000A;you first have to call `var struct = d3.hierarchy(myJsonObj)` to convert it and then pass it to your layout.&#x000A;&#x000A;--&#x000A;&#x000A;* There are new methods for aggregating special nodes like:&#x000A; * `nodes.leaves` to get just leaf nodes&#x000A; * `nodes.descendents`&#x000A; * `nodes.anscestors`&#x000A; * To get the links in the form of {source, target} call `nodes.links` (which you used to obtain from your layouts.)&#x000A;&#x000A;&#x000A;---&#x000A;&#x000A;# Queue ([d3-queue](https://github.com/d3/d3-queue/blob/master/README.md))&#x000A;&#x000A;* A queue evaluates zero or more deferred asynchronous tasks with configurable concurrency&#x000A;* Used to be a separate library, now included in the default bundle as `d3.queue`.&#x000A;&#x000A;```javascript&#x000A;d3.queue()&#x000A;  .defer(d3.json, 'states.json')&#x000A;  .defer(d3.json, 'cities.json')&#x000A;  .await(function(error, states, cities) {&#x000A;    // make map&#x000A;  });&#x000A;&#x000A;// or:&#x000A;&#x000A;d3.queue()&#x000A;  .defer(d3.json, 'states.json')&#x000A;  .defer(d3.json, 'cities.json')&#x000A;  .awaitAll(function(error, results) {&#x000A;    // results is an array of the returned objects.&#x000A;  });&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Delimiter-Separated Values ([d3-dsv](https://github.com/d3/d3-dsv/blob/master/README.md))&#x000A;&#x000A;* Lots of renaming:&#x000A;&#x000A; * `d3.csv.parse` &#8594; `d3.csvParse`&#x000A; * `d3.csv.parseRows` &#8594; `d3.csvParseRows`&#x000A;&#x000A;--&#x000A;&#x000A;* The original `d3.csv` and `d3.tsv` for loading files have not been renamed.&#x000A;&#x000A;--&#x000A;&#x000A;* There is no more `d3.dsv` for custom formatters, you can now use `d3.dsvFormat("|")` to define a new formatter and parser.&#x000A;&#x000A;--&#x000A;&#x000A;* The parse method now exposes column names:&#x000A;&#x000A;```javascript&#x000A;d3.csv("cars.csv", function(error, data) {&#x000A;  if (error) throw error;&#x000A;  console.log(data.columns); // ["Year", "Make", "Model", "Length"]&#x000A;});&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Polygons ([d3-polygon](https://github.com/d3/d3-polygon/blob/master/README.md))&#x000A;&#x000A;* `d3.geom.polygon` is gone and there is no `d3.polygon`.&#x000A;&#x000A;* Now using `d3.polygonHull(points)` which returns the convex hull of the specified points. The returned hull is represented as an array containing a <i>subset</i> of the input points arranged in counterclockwise order.&#x000A;&#x000A;--&#x000A;&#x000A;Some helper methods to call with the results of polygonHull:&#x000A; * `d3.polygonArea` - area of polygon&#x000A; * `d3.polygonCentroid` - center point of polygon&#x000A; * `d3.polygonContains` - checks if a point is inside of a polygon.&#x000A; * `d3.polygonLength` - returns the length of the perimiter.&#x000A;&#x000A;Example [here](http://bl.ocks.org/mbostock/6f14f7b7f267a85f7cdc)&#x000A;---&#x000A;&#x000A;# Quadtree ([d3-quadtree](https://github.com/d3/d3-quadtree/blob/master/README.md))&#x000A;&#x000A;A quadtree recursively partitions two-dimensional space into squares, dividing each square into four equally-sized squares.&#x000A;http://bl.ocks.org/mbostock/9078690&#x000A;&#x000A;* `d3.geom.quadtree` &#8594; `d3.quadtree`&#x000A;* Quadtree is no longer a generator. Instead of defining a quadtree function that you pass your data to, you add your data to the quadtree you're generating using the `add`&#x000A; or `addAll` methods:&#x000A;&#x000A;In v3:&#x000A;```javascript&#x000A;var quadtree = d3.geom.quadtree()&#x000A;    .extent([[0, 0], [width, height]]);&#x000A;quadtree(data);&#x000A;```&#x000A;&#x000A;In V4:&#x000A;```javascript&#x000A;var quadtree = d3.quadtree()&#x000A;    .extent([[0, 0], [width, height]])&#x000A;    .addAll(data);&#x000A;```&#x000A;&#x000A;---&#x000A;&#x000A;# Quadtree ([d3-quadtree](https://github.com/d3/d3-quadtree/blob/master/README.md))&#x000A;&#x000A;* Previously the quadtree generator returned the root node, now you can get it by calling `quadtree.root`.&#x000A;&#x000A;--&#x000A;&#x000A;* The `leaf` boolean flag on nodes is gone, now you can use `node.length` to determine if the node has children instead.&#x000A;&#x000A;--&#x000A;&#x000A;* `quadtree.find` now takes an optional radius (in screen px) that its search will be restricted to - useful when your quadtree has a lot of points.&#x000A;&#x000A;--&#x000A;&#x000A;* Implementation no longer recursive and much faster.&#x000A;&#x000A;---&#x000A;&#x000A;&#x000A;# Other small but notable&#x000A;&#x000A;* Written in strict mode&#x000A;&#x000A;--&#x000A;&#x000A;* `d3-geo` introduces `fitSize`, the [greatest thing since sliced bread](http://bl.ocks.org/mbostock/19ffece0a45434b0eef3cc4f973d1e3d)&#x000A;--&#x000A;&#x000A;* The default build is anonymous (aka no global `d3` object is exported if AMD or CommonJS is detected.)&#x000A;&#x000A;--&#x000A;&#x000A;* Uses only ASCII variable names and ASCII string literals. No more requirement to be explicit about UTF-8.&#x000A;&#x000A;--&#x000A;&#x000A;* `d3.format` now has text formatting: `d3.format(">10c")("foo"); // "       foo"`&#x000A;&#x000A;--&#x000A;&#x000A;* You can set a default locale based on country for some of your number parsing with `d3.formatDefaultLocale` [link](https://npmcdn.com/d3-format@1.0.1/locale/)&#x000A;&#x000A;--&#x000A;&#x000A;* New random number generators for exponential and uniform distributions.&#x000A;&#x000A;--&#x000A;&#x000A;* `d3.xhr` is now `d3.request`, which also supports basic auth by calling `.user` and `.password` methods. &#x000A;&#x000A;&#x000A;---&#x000A;&#x000A;# Not covered:&#x000A;&#x000A;* Chord diagrams ([d3-chord](https://github.com/d3/d3-chord/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#chords-d3-chord)&#x000A;* Number formatting ([d3-format](https://github.com/d3/d3-format/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#number-formats-d3-format)&#x000A;* Geography ([d3-geo](https://github.com/d3/d3-geo/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#geographies-d3-geo)&#x000A;* Hierarchical layouts ([d3-hierarchy](https://github.com/d3/d3-hierarchy)) such as treemaps, circle packing etc. [changes](https://github.com/d3/d3/blob/master/CHANGES.md#hierarchies-d3-hierarchy)&#x000A;* Interpolators ([d3-interpolate](https://github.com/d3/d3-interpolate/blob/master/README.md)) - interpolation methods [changes](https://github.com/d3/d3/blob/master/CHANGES.md#interpolators-d3-interpolate)&#x000A;* Time formats ([d3-time-format](https://github.com/d3/d3/blob/master/CHANGES.md#time-formats-d3-time-format)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#time-formats-d3-time-format)&#x000A;* Timers ([d3-timer](https://github.com/d3/d3-timer/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#timers-d3-timer)&#x000A;* Voronoi diagrams ([d3-voronoi](https://github.com/d3/d3-voronoi/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#voronoi-diagrams-d3-voronoi)&#x000A;* Zooming ([d3-zoom](https://github.com/d3/d3-zoom/blob/master/README.md)) [changes](https://github.com/d3/d3/blob/master/CHANGES.md#zooming-d3-zoom)&#x000A;&#x000A;---&#x000A;&#x000A;class: center, middle, inverse&#x000A;&#x000A;# Thanks!&#x000A;&#x000A;&#x000A;&#x000A;<div class="bottom-left">&#x000A;<a href="http://ireneros.com">Irene Ros</a><br/>&#x000A;<a href="http://twitter.com/ireneros">@ireneros</a><br/>&#x000A;irene@bocoup.com <br/><br/>&#x000A;<a href="http://bocoup.com/datavis">&#x000A;  <img src="stylesheets/images/bocoup.png" />&#x000A;</a><br />&#x000A;&#x000A;</div></textarea>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>
